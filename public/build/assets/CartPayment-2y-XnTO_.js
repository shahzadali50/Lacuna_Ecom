import{d as J,n as D,c as R,C as M,r as E,f as P,o as f,w as u,e as l,b as s,u as r,m as X,q as j,a as h,P as G,g as y,aF as W,av as I,aw as T,t as p,s as $,F as K,v as Q,aD as Y}from"./app-C9NPN8YL.js";import{_ as z}from"./UserLayout.vue_vue_type_script_setup_true_lang-KxJam3oi.js";import{_ as H}from"./Button.vue_vue_type_script_setup_true_lang-Cd4OMETV.js";import{S as Z}from"./ShoppingCartOutlined-CnlcxnL7.js";import{L as ee}from"./loader-circle-Duqf9zpJ.js";import{S as te}from"./ShoppingOutlined-Bm8hxjj4.js";import"./useFlashMessages-DxL5MwKF.js";import"./LanguageSwitcher.vue_vue_type_script_setup_true_lang-cHfJrG5p.js";import"./createLucideIcon-H0ofV9Az.js";var A="basil",re=function(e){return e===3?"v3":e},F="https://js.stripe.com",se="".concat(F,"/").concat(A,"/stripe.js"),ne=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,oe=/^https:\/\/js\.stripe\.com\/(v3|[a-z]+)\/stripe\.js(\?.*)?$/;var ae=function(e){return ne.test(e)||oe.test(e)},ie=function(){for(var e=document.querySelectorAll('script[src^="'.concat(F,'"]')),t=0;t<e.length;t++){var n=e[t];if(ae(n.src))return n}return null},U=function(e){var t="",n=document.createElement("script");n.src="".concat(se).concat(t);var o=document.head||document.body;if(!o)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return o.appendChild(n),n},le=function(e,t){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"7.3.1",startTime:t})},x=null,k=null,C=null,ce=function(e){return function(t){e(new Error("Failed to load Stripe.js",{cause:t}))}},ue=function(e,t){return function(){window.Stripe?e(window.Stripe):t(new Error("Stripe.js not available"))}},de=function(e){return x!==null?x:(x=new Promise(function(t,n){if(typeof window>"u"||typeof document>"u"){t(null);return}if(window.Stripe){t(window.Stripe);return}try{var o=ie();if(!(o&&e)){if(!o)o=U(e);else if(o&&C!==null&&k!==null){var m;o.removeEventListener("load",C),o.removeEventListener("error",k),(m=o.parentNode)===null||m===void 0||m.removeChild(o),o=U(e)}}C=ue(t,n),k=ce(n),o.addEventListener("load",C),o.addEventListener("error",k)}catch(i){n(i);return}}),x.catch(function(t){return x=null,Promise.reject(t)}))},pe=function(e,t,n){if(e===null)return null;var o=t[0],m=o.match(/^pk_test/),i=re(e.version),b=A;m&&i!==b&&console.warn("Stripe.js@".concat(i," was loaded on the page, but @stripe/stripe-js@").concat("7.3.1"," expected Stripe.js@").concat(b,". This may result in unexpected behavior. For more information, see https://docs.stripe.com/sdks/stripejs-versioning"));var g=e.apply(void 0,t);return le(g,n),g},S,N=!1,q=function(){return S||(S=de(null).catch(function(e){return S=null,Promise.reject(e)}),S)};Promise.resolve().then(function(){return q()}).catch(function(d){N||console.warn(d)});var me=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];N=!0;var o=Date.now();return q().then(function(m){return pe(m,t,o)})};const fe={class:"py-14"},ve={class:"container mx-auto px-2 sm:px-4"},_e={class:"text-center"},he={class:"text-gray-500 text-2xl"},ye={key:0,class:"mb-4 p-4 bg-red-50 border border-red-200 rounded-lg"},xe={class:"list-disc list-inside text-red-600"},Se={key:0,class:"text-red-500"},be={class:"text-2xl sm:text-3xl font-bold text-gray-900 mb-6"},ge={class:""},we={class:"flex items-center"},Ee={class:"text-gray-500 text-sm ml-6"},Pe={class:"flex justify-between mb-4 border-b py-4"},je={class:""},ke={class:"text-slate-500"},Ce={class:"flex justify-between mb-4 border-b py-4"},Le={class:""},Re={class:"text-slate-500"},Te={class:"flex justify-between mb-4"},Oe={class:""},Ve={class:"text-slate-500"},Je=J({__name:"CartPayment",setup(d){const e=D(),t=R(()=>{var c;return((c=e.props.translations)==null?void 0:c.cart_checkout)||{}}),n=R(()=>D().props.cart||[]),o=R(()=>n.value.reduce((c,a)=>c+a.total_price,0)),m=c=>new Intl.NumberFormat("en-US",{style:"currency",currency:"PKR",minimumFractionDigits:2}).format(c),i=M({payment_method:""}),b=()=>{i.post(route("order.generate"),{onSuccess:()=>{i.reset()}})},g=me("pk_test_51RYMTBQMr3lJT8elm07sD9PQEnbaGh65DcosfmGAoyyJ70JDSARshmVUHwY31kPxzNGl2nqOvyuXQ6GPOyhb0Zqd00SnqRCf8y"),B=async()=>{var w;const c=await g,L=await(await fetch("/create-checkout-session",{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":((w=document.querySelector('meta[name="csrf-token"]'))==null?void 0:w.getAttribute("content"))||""}})).json(),v=await(c==null?void 0:c.redirectToCheckout({sessionId:L.id}));v!=null&&v.error&&alert(v.error.message)};return(c,a)=>{const L=E("a-alert"),v=E("a-radio"),w=E("a-radio-group"),O=E("a-button");return f(),P(z,null,{default:u(()=>{var V;return[l(r(X),{title:"Payment"}),s("section",fe,[s("div",ve,[l(r(G),{href:c.route("cart.checkout"),class:"flex items-center mb-2"},{default:u(()=>[l(r(W)),a[2]||(a[2]=y("Back"))]),_:1},8,["href"]),(V=r(e).props.flash)!=null&&V.success?(f(),P(L,{key:0,class:"my-1",message:r(e).props.flash.success,type:"success","show-icon":""},null,8,["message"])):j("",!0),!n.value||n.value.length===0?(f(),P(r(I),{key:1,class:"py-10"},{default:u(()=>[l(r(T),{span:"24"},{default:u(()=>[s("div",_e,[l(r(Z),{class:"text-7xl text-gray-400 mb-4"}),s("h4",he,p(t.value.cart_empty||"Your cart is empty"),1),l(r(G),{href:c.route("home"),class:"inline-block mt-4"},{default:u(()=>[l(r(H),null,{default:u(()=>[y(p(t.value.continue_shopping||"Continue Shopping"),1)]),_:1})]),_:1},8,["href"])])]),_:1})]),_:1})):(f(),h("form",{key:2,class:"w-full",onSubmit:a[1]||(a[1]=$(_=>b(),["prevent"]))},[Object.keys(r(i).errors).length>0?(f(),h("div",ye,[s("ul",xe,[(f(!0),h(K,null,Q(Object.values(r(i).errors),_=>(f(),h("li",{key:_,class:"mb-1"},p(_),1))),128))])])):j("",!0),l(r(I),{class:"justify-between px-6"},{default:u(()=>[l(r(T),{xs:24,md:10,class:"mb-5 order-2 md:order-1"},{default:u(()=>[s("div",null,[a[5]||(a[5]=s("h1",{class:"text-5xl font-bold text-green-800 mb-6 flex items-center gap-2"}," 2. ",-1)),r(i).errors.payment_method?(f(),h("div",Se,p(r(i).errors.payment_method),1)):j("",!0),s("h1",be,p(t.value.payment_method||"Payment Method"),1),s("div",ge,[s("div",we,[l(w,{value:r(i).payment_method,"onUpdate:value":a[0]||(a[0]=_=>r(i).payment_method=_),class:"ml-2"},{default:u(()=>[l(v,{value:"Cash On Delivery"},{default:u(()=>[y(p(t.value.cash_on_delivery||"Cash On Delivery"),1)]),_:1})]),_:1},8,["value"])]),s("p",Ee,p(t.value.pay_cash_on_delivery||"Pay with cash upon delivery."),1)]),s("div",null,[l(O,{"html-type":"submit",class:"w-full btn-primary mt-5 flex items-center justify-center py-4",disabled:r(i).processing},Y({default:u(()=>[r(i).processing?(f(),P(r(ee),{key:0,class:"h-4 w-4 animate-spin mr-2"})):j("",!0),a[3]||(a[3]=y(" Save "))]),_:2},[r(i).processing?void 0:{name:"icon",fn:u(()=>[l(r(te))]),key:"0"}]),1032,["disabled"]),l(O,{type:"primary",class:"w-full mt-4",onClick:B},{default:u(()=>a[4]||(a[4]=[y(" Pay with Card (Stripe) ")])),_:1})])])]),_:1}),l(r(T),{xs:24,md:10,class:"mb-5 order-1 md:order-2 p-4",style:{"box-shadow":"rgba(0, 0, 0, 0.05) 0px 6px 24px 0px, rgba(0, 0, 0, 0.08) 0px 0px 0px 1px"}},{default:u(()=>[a[6]||(a[6]=s("div",null,[s("h1",{class:"text-2xl font-bold text-gray-900 mb-6"}," Order Summary ")],-1)),s("div",Pe,[s("span",je,p(t.value.subtotal||"Subtotal"),1),s("span",ke,p(m(o.value)),1)]),s("div",Ce,[s("span",Le,p(t.value.shipping_charge||"Shipping"),1),s("span",Re,p(t.value.free_delivery||"Free Delivery"),1)]),s("div",Te,[s("span",Oe,p(t.value.total||"Total")+":",1),s("span",Ve,p(m(o.value)),1)])]),_:1})]),_:1})],32))])])]}),_:1})}}});export{Je as default};
